<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.imobpay.base.dao.PayuserDao">

	
	<sql id="paramSql">
		<!--  此处一定要增加一个查询 -->
		<if test="logintag !=null and logintag !=''">
			AND LOGINTAG =  #{logintag}
		</if>
		<if test="timestamp !=null and timestamp !=''">
			AND TIMESTAMP =  #{timestamp}
		</if>
		<if test="branchid !=null and branchid !=''">
			AND BRANCHID =  #{branchid}
		</if>
		<if test="userid !=null and userid !=''">
			AND USERID =  #{userid}
		</if>
		<if test="customerid !=null and customerid !=''">
			AND CUSTOMERID =  #{customerid}
		</if>
		<if test="useridtype !=null and useridtype !=''">
			AND USERIDTYPE =  #{useridtype}
		</if>
	</sql>
	
	<parameterMap type="com.imobpay.base.entity.Payuser" id="paramIdPayuser">
		<parameter property="pageflag"  javaType="Boolean" jdbcType="VARCHAR" mode="IN" />
		<parameter property="curPage"   javaType="Integer" jdbcType="NUMERIC" mode="IN" />
		<parameter property="pageSize"  javaType="Integer" jdbcType="NUMERIC" mode="IN" />
		<parameter property="logintag" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="timestamp" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="branchid" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="userid" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="customerid" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="useridtype" javaType="String" jdbcType="VARCHAR" mode="IN"   />
	</parameterMap>

	<resultMap type="com.imobpay.base.entity.Payuser" id="resultTbPayuser">
		<result column="LOGINTAG" property="logintag" javaType="String" jdbcType="VARCHAR" />
		<result column="TIMESTAMP" property="timestamp" javaType="String" jdbcType="VARCHAR" />
		<result column="BRANCHID" property="branchid" javaType="String" jdbcType="VARCHAR" />
		<result column="USERID" property="userid" javaType="String" jdbcType="VARCHAR" />
		<result column="CUSTOMERID" property="customerid" javaType="String" jdbcType="VARCHAR" />
		<result column="USERIDTYPE" property="useridtype" javaType="String" jdbcType="VARCHAR" />
	</resultMap>

	<select id="selectById" parameterMap="paramIdPayuser" resultMap="resultTbPayuser">
		SELECT * FROM PAYUSER WHERE  ROWNUM = 1  
		<include refid="paramSql"></include>
	</select>
	
	<select id="list" parameterMap="paramIdPayuser" resultMap="resultTbPayuser">
		<if test="pageflag==true">
			SELECT * FROM (
				SELECT A.*, ROWNUM RN FROM
				(
					SELECT * FROM PAYUSER WHERE 1=1
					<include refid="paramSql"></include>
				) A WHERE ROWNUM &lt;= #{curPage}*#{pageSize}
				) WHERE RN  &gt;=
			(#{curPage}-1)*#{pageSize}
		</if>
		<if test="pageBlag==false">
			SELECT * FROM PAYUSER
			WHERE 1=1
			<include refid="paramSql"></include>
		</if>
	</select>
	
	<select id="selBlackUserBlack" parameterMap="paramIdPayuser" resultMap="resultTbPayuser">
		SELECT CUSTOMERID
			FROM PAYBLACKLIST T1, PAYUSER T2
		WHERE T1.BLACKKEY = T2.USERID
			AND T1.BLACKTYPE = '01'
			AND T2.CUSTOMERID = #{customerid}
	</select>
	
	
	<select id="listCount" parameterMap="paramIdPayuser" resultType="Integer">
				SELECT count(1) as count FROM PAYUSER
				WHERE 1=1 
				<include refid="paramSql"></include>
	</select>
	
	<!-- 添加 -->
	<insert id="insert" parameterMap="paramIdPayuser" timeout="1000"  >
		INSERT INTO 
		PAYUSER(
LOGINTAG,
		TIMESTAMP,
		BRANCHID,
		USERID,
		CUSTOMERID,
				USERIDTYPE
		
		)
		VALUES(		#{logintag},
				#{timestamp},
				#{branchid},
				#{userid},
				#{customerid},
		
#{useridtype})
	</insert>
	
	<!-- 修改 -->
	<update id="update"  timeout="1000" >
		UPDATE PAYUSER 
		<trim prefix="SET" prefixOverrides="SET ,">
		<if test="logintag !=null and logintag !=''">
			,LOGINTAG = #{logintag}  
		</if>
		<if test="timestamp !=null and timestamp !=''">
			,TIMESTAMP = #{timestamp}  
		</if>
		<if test="branchid !=null and branchid !=''">
			,BRANCHID = #{branchid}  
		</if>
		<if test="userid !=null and userid !=''">
			,USERID = #{userid}  
		</if>
		<if test="customerid !=null and customerid !=''">
			,CUSTOMERID = #{customerid}  
		</if>
		<if test="useridtype !=null and useridtype !=''">
			,USERIDTYPE = #{useridtype}  
		</if>
		</trim>
		WHERE 1=1
		<include refid="paramSql"></include>
	</update>
	
</mapper>
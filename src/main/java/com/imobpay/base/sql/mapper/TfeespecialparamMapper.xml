<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.imobpay.base.dao.TfeespecialparamDao">

	
	<sql id="paramSql">
		<!--  此处一定要增加一个查询 -->
		<if test="fsSettfeeid !=null and fsSettfeeid !=''">
			AND FS_SETTFEEID =  #{fsSettfeeid}
		</if>
		<if test="fsFeeid !=null and fsFeeid !=''">
			AND FS_FEEID =  #{fsFeeid}
		</if>
		<if test="fsDelaytype !=null and fsDelaytype !=''">
			AND FS_DELAYTYPE =  #{fsDelaytype}
		</if>
		<if test="flParamid !=null and flParamid !=''">
			AND FL_PARAMID =  #{flParamid}
		</if>
		<if test="fsEnddate !=null and fsEnddate !=''">
			AND FS_ENDDATE =  #{fsEnddate}
		</if>
		<if test="fsBusitype !=null and fsBusitype !=''">
			AND FS_BUSITYPE =  #{fsBusitype}
		</if>
		<if test="fsBranchid !=null and fsBranchid !=''">
			AND FS_BRANCHID =  #{fsBranchid}
		</if>
		<if test="fsStartdate !=null and fsStartdate !=''">
			AND FS_STARTDATE =  #{fsStartdate}
		</if>
	</sql>
	
	<parameterMap type="com.imobpay.base.entity.Tfeespecialparam" id="paramIdTfeespecialparam">
		<parameter property="pageflag"  javaType="Boolean" jdbcType="VARCHAR" mode="IN" />
		<parameter property="curPage"   javaType="Integer" jdbcType="NUMERIC" mode="IN" />
		<parameter property="pageSize"  javaType="Integer" jdbcType="NUMERIC" mode="IN" />
		<parameter property="fsSettfeeid" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="fsFeeid" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="fsDelaytype" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="flParamid" javaType="Integer" jdbcType="NUMERIC" mode="IN"   />
		<parameter property="fsEnddate" javaType="String" jdbcType="CHAR" mode="IN"   />
		<parameter property="fsBusitype" javaType="String" jdbcType="CHAR" mode="IN"   />
		<parameter property="fsBranchid" javaType="String" jdbcType="VARCHAR" mode="IN"   />
		<parameter property="fsStartdate" javaType="String" jdbcType="CHAR" mode="IN"   />
	</parameterMap>

	<resultMap type="com.imobpay.base.entity.Tfeespecialparam" id="resultTbTfeespecialparam">
		<result column="FS_SETTFEEID" property="fsSettfeeid" javaType="String" jdbcType="VARCHAR" />
		<result column="FS_FEEID" property="fsFeeid" javaType="String" jdbcType="VARCHAR" />
		<result column="FS_DELAYTYPE" property="fsDelaytype" javaType="String" jdbcType="VARCHAR" />
		<result column="FL_PARAMID" property="flParamid" javaType="Integer" jdbcType="NUMERIC" />
		<result column="FS_ENDDATE" property="fsEnddate" javaType="String" jdbcType="CHAR" />
		<result column="FS_BUSITYPE" property="fsBusitype" javaType="String" jdbcType="CHAR" />
		<result column="FS_BRANCHID" property="fsBranchid" javaType="String" jdbcType="VARCHAR" />
		<result column="fs_feemode" property="fsStartdate" javaType="String" jdbcType="CHAR" />
		<result column="FL_FEERATE" property="feerate" javaType="BigDecimal" jdbcType="NUMERIC" />
		<result column="FS_FEEMODE" property="feemode" javaType="String" jdbcType="CHAR" />
		<result column="FL_FEE" property="fee" javaType="BigDecimal" jdbcType="NUMERIC" />
		<result column="FS_SERFEE" property="shfee" javaType="BigDecimal" jdbcType="NUMERIC" />
		<result column="FL_FEEMIN" property="feemin" javaType="BigDecimal" jdbcType="NUMERIC" />
		<result column="FL_FEEMAX" property="feemax" javaType="BigDecimal" jdbcType="NUMERIC" />
	</resultMap>

	<select id="selectById" parameterMap="paramIdTfeespecialparam" resultMap="resultTbTfeespecialparam">
		SELECT * FROM qtfund.TFEESPECIALPARAM WHERE  ROWNUM = 1  
		<include refid="paramSql"></include>
	</select>
	
	<select id="list" parameterMap="paramIdTfeespecialparam" resultMap="resultTbTfeespecialparam">
		<if test="pageflag==true">
			SELECT * FROM (
				SELECT A.*, ROWNUM RN FROM
				(
					SELECT * FROM qtfund.TFEESPECIALPARAM WHERE 1=1
					<include refid="paramSql"></include>
				) A WHERE ROWNUM &lt;= #{curPage}*#{pageSize}
				) WHERE RN  &gt;=
			(#{curPage}-1)*#{pageSize}
		</if>
		<if test="pageBlag==false">
			SELECT * FROM qtfund.TFEESPECIALPARAM
			WHERE 1=1
			<include refid="paramSql"></include>
		</if>
	</select>
	<select id="querySpercialFee" parameterMap="paramIdTfeespecialparam" resultMap="resultTbTfeespecialparam">
				 select f.fs_branchid as fsBranchid,
				       f.fs_delaytype as fsDelaytype,
				       f.fs_busitype as fsBusitype,
				       tf.fs_feemode as feemode,
				       tf.fl_fee as fee,
				       tf.fl_feerate as feerate,
				       tf.fl_feemax as feemax,
				       tf.fl_feemin as feemin,
				       tf.fs_serfee as shfee
				  from qtfund.tfeespecialparam f
				  left join qtfund.tfee tf
				    on f.fs_feeid = tf.fs_feeid
				 WHERE  
				 	f.fs_busitype = #{fsBusitype}
				   and f.fs_branchid = #{fsBranchid}
				   and f.fs_startdate &gt;= #{fsStartdate}
				   and f.fs_enddate &lt;= #{fsEnddate}
	</select>
	
	<select id="listCount" parameterMap="paramIdTfeespecialparam" resultType="Integer">
				SELECT count(1) as count FROM qtfund.TFEESPECIALPARAM
				WHERE 1=1 
				<include refid="paramSql"></include>
	</select>
	
	<!-- 添加 -->
	<insert id="insert" parameterMap="paramIdTfeespecialparam" timeout="1000"  >
		INSERT INTO 
		qtfund.TFEESPECIALPARAM(
FS_SETTFEEID,
		FS_FEEID,
		FS_DELAYTYPE,
		FL_PARAMID,
		FS_ENDDATE,
		FS_BUSITYPE,
		FS_BRANCHID,
				FS_STARTDATE
		
		)
		VALUES(		#{fsSettfeeid},
				#{fsFeeid},
				#{fsDelaytype},
				#{flParamid},
				#{fsEnddate},
				#{fsBusitype},
				#{fsBranchid},
		
#{fsStartdate})
	</insert>
	
	<!-- 修改 -->
	<update id="update"  timeout="1000" >
		UPDATE qtfund.TFEESPECIALPARAM 
		<trim prefix="SET" prefixOverrides="SET ,">
		<if test="fsSettfeeid !=null and fsSettfeeid !=''">
			,FS_SETTFEEID = #{fsSettfeeid}  
		</if>
		<if test="fsFeeid !=null and fsFeeid !=''">
			,FS_FEEID = #{fsFeeid}  
		</if>
		<if test="fsDelaytype !=null and fsDelaytype !=''">
			,FS_DELAYTYPE = #{fsDelaytype}  
		</if>
		<if test="flParamid !=null and flParamid !=''">
			,FL_PARAMID = #{flParamid}  
		</if>
		<if test="fsEnddate !=null and fsEnddate !=''">
			,FS_ENDDATE = #{fsEnddate}  
		</if>
		<if test="fsBusitype !=null and fsBusitype !=''">
			,FS_BUSITYPE = #{fsBusitype}  
		</if>
		<if test="fsBranchid !=null and fsBranchid !=''">
			,FS_BRANCHID = #{fsBranchid}  
		</if>
		<if test="fsStartdate !=null and fsStartdate !=''">
			,FS_STARTDATE = #{fsStartdate}  
		</if>
		</trim>
		WHERE 1=1
		<include refid="paramSql"></include>
	</update>
	
</mapper>